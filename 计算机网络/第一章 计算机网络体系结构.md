## 一、计算机网络概述

### 1、计算机网络的概念
- 早期的一个最简单定义：互联、自治、计算机系统的集合
	+ **互连**：指计算机之间可以通过有线或无线的方式进行数据通信
	+ **自治**：指独立的计算机，它有自己的硬件和软件，可以单独运行使用
	+ **集合**：指至少需要两台计算机

- 现阶段的一个较好的定义：
	- 计算机网络主要是由一些**通用的、可编程的硬件互连而成**的，而这些硬件并非专门用来实现某一特定目的（例如，传送数据或视频信号）
	- 这些可编程的硬件能够用来传送多种不同类型的数据，并能支持广泛的和日益增长的应用

### 2、计算机网络的组成
#### （1）从组成部分上
- **硬件**：主要由主机（端系统）、通信链路（如双绞线、光纤）、交换设备（如路由器、交换机等) 和通信处理机（如网卡）等组成	
- **软件**：主要包括各种实现资源共享的软件和方便用户使用的各种工具软件（如网络操作系统、邮件收发程序、FTP 程序、聊天程序等)
- **协议**：计算机网络的核心，规定了网络传输数据时所遵循的规范

#### （2）从工作方式上
- **边缘部分**：
	- 由所有连接到因特网上、供用户直接使用的**主机**组成
	- 用来进行通信（如传输数据、音频或视频）和资源共享
- **核心部分**：
	- 由大量的网络和连接这些网络的**路由器**组成
	- 为边缘部分提供连通性和交换服务
![image-20231111183301374](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231111183301374.png)

#### （4）从功能组成上
- **通信子网**：
	- 由各种**传输介质、通信设备和相应的网络协议**组成
	- 使网络具有数据传输、交换、控制和存储的能力，实现联网计算机之间的数据通信
- **资源子网**：
	- 是实现资源共享功能的**设备及其软件的集合**
	- 向网络用户提供共享其他计算机上的硬件资源、软件资源和数据资源的服务

### 3、计算机网络的功能
- **数据通信**：最基本的功能
- **资源共享**：包括软件共享、硬件共享
- **分布式管理**
- **提高可靠性**
- **负载均衡**

### 4、电路、报文、分组交换
- 网络核心是计算机网络（特别是因特网）中最复杂的部分。
- 网络核心要**向网络边缘中的大量主机提供连通性**，使边缘部分中的任何一个主机都能够与其他主机通信。
- **路由器 (Router) 是网络核心中最主要的设备，其主要功能是数据交换**，即接收来自源主机系统的数据，并向目的主机系统转发。
- 在计算机网络中，路由器转发的数据称为**数据分组**（Packet Switching）。

#### （1）电路交换 (Circuit Switching) 
- **电路交换**：
	- 电话交换机接通电话线的方式
	- **交换**的含义：转接——把一条电话线转接到另一条电话线，使它们连通起来
	- 从通信资源分配角度来看：**交换就是按照某种方式动态地分配传输线路的资源**

- **电路交换的步骤** 
	1. 建立连接：分配通信资源
	2. 数据传输：一直占用通信资源
	3. 释放连接：归还通信资源

- **电路交换的关键点**：用户始终占用着端到端的固定传输带宽
![](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231114212536475.png)

| 优点                                          | 缺点                                      |
| ------------------------------------------- | --------------------------------------- |
| **通信时延小**：通信线路为通信双方专用的，数据直达                 | **建立连接时间长**                             |
| **有序传输**：通信双方只有一条专用通信线路，数据只在这一线路上传输，不存在失序问题 | 线路独占，**使用效率低**                          |
| **没有冲突**：不同的通信双方拥有不同的信道，不会出现争用物理通道的问题       | **不便于差错控制**：中间结点不具备存储和检验数据的能力，无法发现并纠正错误 |
| **适用范围广**：适用于传输模拟信号，也适用于传输数字信号              | **难以规格化**                               |
| **实时性强**：时延小所以实时性强                          | **灵活性差**                                |
| **控制简单**                                    |                                         |

#### （2）报文交换 (Message Switching) 
- 是分组交换的前身
- 报文被整个发送，**数据交换的单位是报文**
- 报文携带有目标地址、源地址等信息
- 报文交换在交换结点采用**存储转发**的传输方式
- 交换节点将报文**整体接收完成后**才能查找转发表，将整个报文**转发**到下一个节点
- 报文大小没有限制

| 优点                                | 缺点                                        |
| --------------------------------- | ----------------------------------------- |
| **无需建立连接**                        | **引起转发时延**：交换结点要将报文整体接收完后，才能查找转发表转发到下一个结点 |
| **动态分配线路**                        | **缓存开销大**：报文大小没有限制，因此交换结点要有较大的缓存空间        |
| **提高线路可靠性**：如果某条线路出现故障，会重新选择另一条线路 | **错误处理低效**：报文较长时，发生错误的概率相对较大，重传整个报文的代价也很大 |
| **提高线路利用率**：通信双方在不同的时间分段占用物理线路    |                                           |
| **提供多目标服务**：一个报文可以同时发送给多个目的地址     |                                           |

#### （3）分组交换 (Packet Switching) 
- 采用**存储转发**技术，解决了报文交换中报文过长的问题：
	- 源结点在发送之前，先把较长的报文划分成若干较小的等长数据段
	- 每个数据段前面添加一些由必要控制信息【源地址、目的地址和编号信息等】组成的**首部，构成分组** (Packet)
- 分组交换还可以进一步分为**面向连接的虚电路方式**和**无连接的数据报方式**，这两种服务方式都由网络层提供

![image-20231114213302494](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231114213302494.png)
+ **发送方**：构建分组 ----> 发送分组
+ **路由器**：缓存分组 ----> 转发分组
+ **接收方**：接收分组 ----> 还原报文

| 优点                                                       | 缺点                                                    |
| -------------------------------------------------------- | ----------------------------------------------------- |
| **无建立时延**                                                | 存在**存储转发时延**                                          |
| **线路利用率高**                                               | 需要传输**额外信息量**(分组首部信息)                                 |
| **简化存储管理**：因为分组大小固定，管理起来就容易一些                            | 当分组交换**采用数据报服务**，可能会出现**失序、丢失、重复分组**                  |
| **加速传输**：因为分组是逐个传输，这样前一个交换机的转发操作与后一个交换机的存储操作可同时进行【流水线方式】 | 当分组交换采**用虚电路服务**，虽然没有分组失序问题，但有**呼叫建立，数据传输和虚电路释放**三个过程 |
| **减小出错率和重复数据量**：分组比报文小，因此出错概率也会比较小，即使出错也只需要重传出错的这一小部分即可  |                                                       |

#### （4） 总结：三种交换对比 
- 若要传送大量数据，并且数据传送时间远大于建立连接的时间，则使用电路交换效率高，然而**计算机的数据传送**往往是**突发式**的，采用电路交换时通信**线路的利用率会很低**

- 报文交换和分组交换都**不需要建立连接**（即预先分配通信资源），在**传送计算机的突发数据**时可以**提高计算机通信线路的利用率**

- 将报文构造成若干个更小的分组进行**分组交换**，比将整个报文进行报文交换的**时延要小**，并且还可以**避免太长的报文长时间占用链路，有利于差错控制**，同时具有更好的灵活性

![image-20231111210454469](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231111210454469.png)

### 5、计算机网络的分类
- **按分布范围**：
	- 广域网 WAN：互联网的核心部分，采用交换技术
	- 城域网 LAN：大多采用以太网技术
	- 局域网 LAN：采用广播技术
	- 个域网 PAN：采用无线技术

- **按传输技术**：
	- 广播式 
	- 点对点

- **按拓扑结构**：
	- 总线形 
	- 星形 
	- 环形
	- 网状形
![image.png](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/20240630160441.png)

- **按交换技术**：
	- 电路交换
	- 报文交换
	- 分组交换

- **按使用者**：
	- 公用网
	- 专用网

- **按传输介质**：
	- 有线网络 
	- 无线网络

- **注意**：
	- 广域网和局域网之间的差异在于：
		- 所覆盖范围不同
		- 所使用的协议和网络技术不同【广域网使用点对点技术，局域网使用广播技术】
	* 广域网基本都属于点对点网络
	* 点对点网络与广播式网络的重要区别：是否采用分组存储转发与路由器选择机制
	- 若中央处理器之间的距离非常近（如仅 1 m 的数量级或更小），则一般称为多处理器系统，而不称为计算机网络
	- 拓扑结构主要是指通信子网的拓扑结构
	- 星形、总线型和环形网络多用于局域网
	- 网状形网络多用于广域网

### 6、计算机网络的性能指标
- 性能指标可以从不同的方面来**度量计算机网络的性能**

####  （1）速率 Speed
- **比特**：
	- 计算机中的**数据量的基本单位**，也是信息论中信息量的单位
	- **一个比特**就是二进制数字中的**一个 1 或 0**
- **速率**：
	- 指连接到网络上的结点在数字信道上传送数据的速率【每秒传送多少个比特】
	- 也称：数据传输速率，数据传输率、比特率或数据率
	- 单位：b/s（比特/秒）
- 速率提高体现在**单位时间内发送到链路上的比特数增多**了，而并不是比特在链路上跑得更快了

![image-20230511111749302](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/408.oss-cn-hangzhou.aliyuncs.com202305111117410.png)

#### （2）带宽 Bandwidth
- 带宽在**模拟信号系统**中的意义：
	- 某个信号所包含的各种不同频率成分所占据的**频率范围**
	- 单位：赫兹 Hz（kHz，MHz，GHz）`
- 带宽在**计算机网络**中的意义：
	- 用来表示网络的**通信线路所能传送数据的能力**
	- 即在**单位时间内**从网络中的某一点到另一点所能通过的**最高数据率**
	- 单位：b/s（kb/s，Mb/s，Gb/s，Tb/s）`
- 数据传送速率 = min【主机接口速率，线路带宽，交换机或路由器的接口速率】
![image-20231114210008325](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231114210008325.png)

#### （3）吞吐量 Throughput
- **吞吐量**：单位时间内通过某个网络 (或信道、接口) 的数据量
- 吞吐量常用在对实际网络的测量中，**受网络的带宽或额定速率的限制**

#### （4）时延 Delay
- 指数据 (一个报文或分组) 从网络 (或链路) 的一端传送到另一端所需的总时间
- 包括：
	- **发送时延** = $\frac{分组长度(b)}{发送速率(b/s)}$，结点将分组的所有比特推向链路所需的时间
	- **传播时延** = $\frac{信道长度(m)}{电磁波在信道上的传播速率(m/s)}$，一个比特从链路一端传播到另一端所需的时间
	- **处理时延**：数据在交换结点为存储转发而进行的--些必要处理所花的时间
	- **排队时延**：分组在进入路由器后要先在输入队列中排队等待处理

![image-20231111184624811](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231111184624811.png)
##### 例题
![image-20231114211305725](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231114211305725.png)

![image-20231114211330955](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231114211330955.png)

#### （5）时延带宽积
- 时延带宽积 = 传播时延 * 信道带宽
- 指发送端发送的第一个比特即将到达终点时，发送端已发出了多少比特
- 也称为**以比特为单位的链路长度**
![image-20231111184730691](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231111184730691.png)

#### （6）往返时间 RTT
- 指从发送端发送数据分组开始，到发送端收到接收端发来的相应确认分组为止，总共耗费的时间

#### （7）利用率
- **信道利用率**：用来表示某链路有百分之几的时间是被利用的 (有数据通过)
- **网络利用率**：全网络所有链路的链路利用率的加权平均

![image-20231111184907780](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231111184907780.png)
+ 根据排队论，当某链路的利用率增大时，该信道引起的时延也会迅速增加，因此**信道利用率不是越高越好**
+ 如果令 $D_0$ 表示网络空闲时的时延，D 表示网络当前的时延
+ 在适当的假定条件下，可以用下面的简单公式来表示 D、$D_0$ 和利用率 U 之间的关系：
  $$
  D=\dfrac{D_0}{1-U}
  $$
  ![image-20231114212157248](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231114212157248.png)
+ 当网络利用率 U 到 50% 时，时延急剧增大
+ 当网络利用率接近 100% 时，时延趋于无穷大
+ 但是也不能使信道利用率过低，这会使宝贵的通信资源被浪费

#### （8）丢包率
- **丢包率**：即分组丢失率，是指在一定的时间范围内，传输过程中**丢失的分组数量与总分组数量的比率**
- 具体可分为：接口丢包率、结点丢包率、链路丢包率、路径丢包率、网络丢包率等
- **分组丢失的两种情况**
	- 分组在传输过程中**出现误码**，被传输路径中的**结点点交换机**（例如路由器）或**目的主机**检测出误码而丢弃
	  - 分组到达一台**队列已满**的分组交换机时被丢弃，在通信量较大时就可能造成网络拥塞
- 丢包率反映了**网络的拥塞情况**：
	- **无拥塞**时路径丢包率为 0
	- 轻度拥塞时路径丢包率为 1%~4%
	- **严重拥塞**时路径丢包率为 5%~15% 

## 二、计算机网络体系结构与参考模型
### 1、计算机网络分层结构

### 2、协议、接口、服务

### 3、参考模型














## :star:体系结构和参考模型

我们把计算机**网络的各层及其协议的集合称为**网络的体系结构（Architecture）。

换言之，计算机网络的体系结构就是这个**计算机网络及其所应完成的功能的精确定义**，它是计算机网络中的**层次、各层的协议及层间接口的集合**。

需要强调的是，这些功能究竟是用何种硬件或软件完成的，则是一个遵循这种体系结构的**实现（Implementation）**问题。

**体系结构是抽象的，而实现是具体的，是真正在运行的计算机硬件和软件**。

### 常见的三种计算机网络体系结构

![image-20231114213857628](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231114213857628.png)

### 分层的必要性

“分层”可将庞大复杂的问题转化为**若干较小的局部问题**

![image-20231111201236143](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231111201236143.png)

- 第n层实体实现的服务为第n+1层所利用。在这种情况下，第n层称为服务提供者，第n+1层则服务于用户。

- 每一层还有自己传送的数据单位，其名称、大小、含义也各有不同。

- 在计算机网络体系结构的各个层次中，每个报文都分为两部分：一是数据部分，即SDU；二是控制信息部分，即PCI，它们共同组成PDU。

$$
PDU=SDU+PCI
$$

* **服务数据单元（SDU）：**同一系统内层与层之间交换的数据包，第n层的服务数据单元记为n-SDU。
* **协议控制信息（PCI）：**控制协议操作的信息，第n层的协议控制信息记为n-PCI。
* **协议数据单元（PDU）：**对等层次之间传送的数据包，第n层的协议数据单元记为n-PDU。

- 在实际的网络中，每层的协议数据单元都有一个通俗的名称。

- 如物理层的PDU称为比特，数据链路层的PDU称为帧，网络层的PDU称为分组，传输层的PDU称为报文段。

- 在各层间传输数据时，把从第n+1层收到的PDU作为第n层的SDU，加上第n层的PCI，就变成了第n层的PDU，交给第n-1层后作为SDU发送，接收方接收时做相反的处理，因此可知三者的关系为

$$
n-SDU+n-PCI=n-PDU=(n-1)-SDU
$$

具体地，层次结构的含义包括以下几方面：

- 第n层的实体不仅要使用第n-1层的服务来实现自身定义的功能，还要向第n+1层提
  供本层的服务，该服务是第n层及其下面各层提供的服务总和。
- 最低层只提供服务，是整个层次结构的基础；中间各层既是下一层的服务使用者，又是
  上一层的服务提供者；最高层面向用户提供服务。
- 上一层只能通过相邻层间的接口使用下一层的服务，而不能调用其他层的服务；下一层
  所提供服务的实现细节对上一层透明。
- 两台主机通信时，对等层在逻辑上有一条直接信道，表现为不经过下层就把信息传送到
  对方。

#### 例题

![image-20231114223853658](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231114223853658.png)

### 专用术语

#### 1.实体

- **实体：**任何可发送或接收信息的**硬件**或者**软件进程**，通常是一个特定的软件模块。

- **对等实体：**收发双方**相同层次**中的实体。

![image-20231111191240416](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231111191240416.png)

#### 2.协议

控制两个对等实体在“**水平方向**” 进行“**逻辑通信**”的规则的集合（这种通信实际上不存在，只是便于我们考虑问题）

![image-20231111191332594](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231111191332594.png)

**三要素：**

+ **语法**：定义所交换**信息的格式**(即报文格式)
+ **语义**：定义收发双方所要完成的**操作**(即收，发任务需要各自定义)
+ **同步**：定义收发双方的**时序关系**(如先建立侦听才可以通信是有先后顺序的)

一个完整的协议通常应该具有**线路管理(建立\连接\释放连接)，差错控制，数据转换**等功能

#### 3.服务

+ 在协议控制下，两个对等实体间的逻辑通信使得本层能够**向上一层提供服务(也就是说通过协议完成本层的内容后就可以向上提供服务)**。
+ 要实现本层协议，还需要使用下面一层所提供的服务。
+ 协议是**"水平的"**，服务是**"垂直的"**。
+ 实体看得见相邻下层所提供的的服务，但是并不知道实现该服务的具体协议。也就是说，下面的协议对上面的实体是**"透明"**的。

![](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231114215343567.png)

**服务原语：**上层使用下层所提供的服务必须通过与下层**交换一些命令**，这些命令称为服务原语。

OSI参考模型将原语划分为4类

- 请求(Requst)
- 指示(Indication)
- 响应(Response)
- 证实(Confirmation)

**服务访问点**`SAP(Service Access Point)`：在同一系统中**相邻两层的实体交换信息的逻辑接口(就像Web里的request域，后端前端都能取到)**，用于区分不同的服务类型。每个`SAP`都有一个能唯一标识它的地址。

- 接口是同一结点内**相邻两层间交换信息的连接点**，是一个系统内部的规定。

- 在典型的接口上，同一结点内相邻两层间实体通过`服务访问点SAP`进行交互，服务是通过`SAP`提供给上层使用的。
  - 链路层的服务访问点：`帧的"类型"字段`
  - 网络层的服务访问点：`IP数据报首部中的"协议字段"`
  - 运输层的服务访问点：`"端口号"`

##### 协议和服务的区别

一定要注意，协议和服务在概念上是不一样的。

- 首先，只有本层协议的实现才能保证向上一层提供服务。本层的服务用户只能看见服务而无法看见下面的协议，即下面的协议对上层的服务用户是透明的。
- 其次，协议是“水平的”，即协议是控制对等实体之间通信的规则。但服务是“垂直的”，即服务是由下层通过层间接口向上层提供的。
- 另外，并非在一层内完成的全部功能都称为服务，只有那些能够被高一层实体“看得见”的功能才称为服务。

###  ISO/OSI参考模型

国际标准化组织（ISO）提出的网络体系结构模型，称为开放系统互连参考模型（OSI/RM）,通常简称为OSI参考模型。OSI参考模型有7层，自下而上依次为物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。低三层统称为通信子网，它是为了联网而附加的通信设备，完成数据的传输功能：高三层统称为资源子网，它相当于计算机系统，完成数据的处理等功能。

#### 1. 物理层（Physical Layer）

- 物理层的**传输单位是比特，**功能是**在物理媒体上为数据端设备透明地传输原始比特流。**

- 物理层主要定义数据终端设备（DTE）和数据通信设备（DCE）的物理与逻辑连接方法，所以物理层协议也称物理层接口标准（物理层规程）。

物理层接口标准很多，如EIA-232C、EIA/TIARS-449、CCITT的X.21等

- 物理层主要研究以下内容：
  - 通信链路与通信结点的连接需要一些电路接口物理层规定了这些接口的一些参数，如机械形尺寸、交换电路的数量和排列等。
  - 物理层也规定了通信链路上传输的信号的意义和电气特征。

采用什么信号表示比特0/1

注意，传输信息所利用的一些物理媒体，如双绞线、光缆、无线信道等，并不在物理层协议
之内而在物理层协议下面。因此，有人把**物理媒体当作第0层。**

#### 2. 数据链路层（Data Link Layer）

- 数据链路层的**传输单位是帧**，任务是**将网络层传来的`IP数据报`封装成帧**。
- 数据链路层的功能可以概括为：**封装成帧、差错控制、流量控制和传输管理**等。

广播式网络在数据链路层还要处理新的问题，即对共享信道的访问，

数据链路层的一个特殊的子层——介质访问层，就是专门处理这个问题的。

* 标识网络中各主机（MAC地址）
* 从比特流中区分出地址和数据（数据封装格式）
* 协调各主机征用总线（媒体接入控制）
* 体验得花交换机的实现（自学习和转发帧）
* 检测数据是否出现误码（差错检测）
* 出现传输差错如何处理（可靠传输和不可靠传输）

典型的数据链路层协议有SDLC、HDLC、PPP、STP和帧中继等

#### 3. 网络层（Network Layer）

- 网络层的**传输单位是数据报，**它关心的是通信子网的运行控制。
- 主要任务是**把网络层的协议数据单元（分组）从源端传到目的端，**为分组交换网上的不同主机提供通信服务。
- 关键问题是对分组进行**路由选择**，并实现流量控制、拥塞控制、差错控制和网际互连等功能。

- 因特网是一个很大的互联网，它由大量异构网络通过路由器（Router）相互连接起来。

- 因特网的主要网络层协议是`无连接的网际协议（Internet Protocol，IP）`和许多路由选择协议。

- 因特网的网络层也称网际层或IP层。

注意，网络层中的“网络”一词并不是我们通常谈及的具体网络，而是在计算机网络体系结构中使用的专有名词。

- 网络层的协议有 IP、IPX、ICMP、IGMP、ARP、RARP和OSPF等
  - 表示网络和网络中的各主机（网络和主机共同编址，例如IP地址）
  - 路由器转发分组（路由器选择协议、路由表和转发表）

#### 4. 传输层(运输层)（Transport Layer）

- 传输层也称运输层，**传输单位是报文段**。
- 传输层负责**主机中两个进程**之间的通信，功能是为端到端连接提供可靠的传输服务，为端到端连接提供流量控制、差错控制、服务质量、数据传输管理等服务。

- 数据链路层提供的是点到点的通信，传输层提供的是端到端的通信，两者不同。
  - 通俗地说，点到点可以理解为主机到主机之间的通信，一个点是指一个硬件地址或I地址，网络中参与通信的主机是通过硬件地址或地址标识的。
  - 端到端的通信是指运行在不同主机内的两个进程之间的通信，一个进程由一个端口来标识，所以称为端到端通信。
- 使用传输层的服务，高层用户可以直接进行端到端的数据传输，从而忽略通信子网的存在。通过传输层的屏蔽，高层用户看不到子网的交替和变化。由于一台主机可同时运行多个进程，因此传输层具有复用和分用的功能。

- 传输层的协议有TCP、UDP。
  - 进程之间基于网络的通信（进程的标识，例如端口号）
  - 出现传输差错如何处理（可靠传输和不可靠传输）

#### 5. 会话层（Session Layer）

- 会话层允许**同主机上的各个进程**之间进行会话。
- 会话层利用传输层提供的端到端的服务，向表示层提供它的增值服务。这种服务主要为表示层实体或用户进程建立连接并在连接上有序地传输数据，这就是会话，也称建立同步（SYN）。

- 会话层负责管理主机间的会话进程，包括建立、管理及终止进程间的会话。
- 会话层可以使用校验点使通信会话在通信失效时从校验点继续恢复通信，实现数据同步。

#### 6. 表示层（Presentation Layer）

- 表示层主要处理在两个通信系统中交换信息的表示方式。
- 不同机器采用的编码和表示方法不同，使用的数据结构也不同。
- 为了使不同表示方法的数据和信息之间能互相交换，表示层采用插象的标准方法定义数据结构，并采用标准的编码形式。
- **数据压缩、加密和解密**也是表示层可提供的数据表示变换功能。

#### 7. 应用层（Application Layer）

- 应用层是OSI参考模型的最高层，是用户与网络的界面。
- 应用层为特定类型的网络应用提供访问0SI参考模型环境的手段。因为用户的实际应用多种多样，这就要求应用层采用不同的应用协议来解决不同类型的应用要求，因此应用层是最复杂的一层，使用的协议也最多。
- 典型的协议有用于文件传送的FTP、用于电子邮件的SMTP、用于万维网的HTTP等。

### TCP/IP模型

ARPA在研究 ARPAnet 时提出了TCP/IP 模型，模型从低到高依次为网络接口层（对应OSI参考模型中的物理层和数据链路层)、网际层、传输层和应用层（对应OSI参考模型中的会话层、表示层和应用层)。TCPIIP 由于得到广泛应用而成为事实上的国际标准。

#### 1. 网络接口层

- 网络接口层的功能类似于OSI参考模型的物理层和数据链路层。
- 它表示与物理网络的接口，但实际上TCP/IP 本身并未真正描述这一部分，只是指出主机必须使用某种协议与网络连接，以便在其上传递IP分组。
- 具体的物理网络既可以是各种类型的局域网，如以太网、令牌环网、令牌总线网等，也可以是诸如电话网、SDH、X.25、帧中继和 ATM等公共数据网络。
- 网络接口层的作用是从主机或结点接收IP分组，并把它们发送到指定的物理网络上。

#### 2. 网际层

- 网际层（主机-主机）是TCP/IP 体系结构的关键部分。它和0SI参考模型的网络层在功能上非常相似
- 网际层将分组发往任何网络，并为之独立地选择合适的路由，但它不保证各个分组有序地到达，各个分组的有序交付由高层负责。
- 网际层定义了标准的分组格式和协议，即 IP。

#### 3. 传输层

- 同样和OSI参考模型中的传输层类似
  - 传输控制协议（Transmission Control Protocol，TCP)，能够提供可靠的交付。
  - 用户数据报协议（User Datagram Protocol，UDP），它是无连接的，数据传输的单位是用
    户数据报，不保证提供可靠的交付，只能提供“尽最大努力交付”。

#### 4. 应用层

应用层（用户——用户或进程——进程）包含所有的高层协议，如虚拟终端协议（Telnet）、文件传输协议（FTP）、域名解析服务（DNS）、电子邮件协议（SMTP）和超文本传输协议（HTTP）。

IP协议是因特网中的核心协议：TCP/IP可以为各式各样的应用提供服务（所谓的everything over IP)，同时TCP/IP也允许IP协议在由各种网络构成的互联网上运行（所谓的IPover everything）。正因为如此，因特网才会发展到今天的规模。

### 总结：TCP/IP模型与OSI参考模型的比较

![image-20231111193119806](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231111193119806.png)

- **TCP/IP模型与OSI参考模型有许多相似之处。**
  - 都采取分层的体系结构。
  - 都是基于独立的协议栈的概念。
  - 都可以解决异构网络的互连，实现世界上不同厂家生产的计算机之间的通信。

- **两个模型除具有这些基本的相似之处外，也有很多差别。**
  - OSI参考模型的最大贡献就是精确地定义了三个主要概念：服务、协议和接口，这与现代的面向对象程序设计思想非常吻合。而TCP/IP 模型在这三个概念上却没有明确区分，不得合软件工程的思想。
  - OSI参考模型产生在协议发明之前，没有偏向于任何特定的协议，通用性良好。但计者在协议方面没有太多经验，不知道把哪些功能放到哪一层更好。TCP/IP模型正好相反，首出现的是协议，模型实际上是对已有协议的描述，因此不会出现协议不能匹配模型的情况，但模型不适合于任何其他非TCP/IP的协议栈。
  - TCP/IP 模型在设计之初就考虑到了多种异构网的互连问题，并将网际协议（IP）作一个单独的重要层次。OSI参考模型最初只考虑到用一种标准的公用数据网将各种不同的系给连。OSI 参考模型认识到IP的重要性后，只好在网络层中划分出一个子层来完成类似于TG模型中的IP的功能。
  - OSI参考模型在网络层支持无连接和面向连接的通信，但在传输层仅有面向连接的通信。而TCP/IP模型认为可靠性是端到端的问题，因此它在网际层仅有一种无连接的通信，但传输层支持无连接和面向连接两种模式。

### 原理体系结构

![image-20231111193415943](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231111193415943.png)

**基于通信协议栈进行通信的结点的数据传输过程**

当我们利用浏览器发送网页请求到服务器并发生响应的过程中，数据会怎么变化呢？

![image-20231111193448491](https://qingwu-oss.oss-cn-heyuan.aliyuncs.com/lian/img/image-20231111193448491.png)

**浏览器发送**

+ 应用层：按照`HTTP协议`的规定构建一个**HTTP请求报文(请求要干什么)**。应用层将`HTTP请求`的报文交给运输层处理。
+ 运输层：给`HTTP请求`报文添加一个**TCP首部(区分应用进程)**，使之成为`TCP报文段`。运输层将`TCP报文段`交给网络层处理。
+ 网络层：给`TCP报文段`添加一个**IP首部(使之可以在互联网上传输)**，使之成为`IP数据报`。网络层将`IP数据报`交付给数据链路层处理。
+ 数据链路层：给`IP数据报`添加一个**首部(让其能在一段链路上传输，能被相应主机接收)**和一个**尾部(让目的主机检查所接收到的帧是否有误码)**，使之成为**帧**。数据链路层将帧交给物理层。
+ 物理层：将帧看作比特流，如果网络是以太网，它还会在帧上加**前导码(让目的主机做好接收帧的准备)**。接着将比特流变成相应信号发送到传输媒体。

**路由器转发**

+ 物理层收到**信号**将其变**为比特流**，去掉前导码后，将其交付给数据链路层**(交付的实际是帧)**。
+ 数据链路层将帧去掉首部和尾部后，将其交付给网络层**(交付的实际是IP数据报)**。
+ 网络层解析`IP数据报`首部，从中提取目的网络地址，然后查找自身路由表，确定转发端口。接着数据链路层封装，物理层再封装，将比特流变成信号发送出去。

**服务器接收**

+ 物理层**收到信号将其变为比特流**，去掉前导码后，将其交付给数据链路层**(交付的实际是帧)**。
+ 数据链路层收到帧后，去除首部和尾部，将其交付给网络层**(交付的实际是IP数据报)**。
+ 网络层收到`IP数据报`后，去除`IP首部`，将其交付给运输层**(交付的实际是TCP报文)**。
+ 运输层收到`TCP报文`后，从中得知是与哪个端口上的进程通信，去除`TCP头部`后，交付给应用层**(交付的实际是HTTP请求报文)**。
+ 应用层收到`HTTP请求`报文后，将其解析给对应进程，并执行相关操作，**返回HTTP响应报文**。
